# Workflow derived from https://github.com/r-lib/actions/tree/master/examples
# Need help debugging build failures? Start at https://github.com/r-lib/actions#where-to-find-help

on:
  push:
    branches: [ "main", "explo-dockerfile","renv_en_folie" ]
  pull_request:
    branches: [ "main" ]

name: Docker Image CI

jobs:

  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Build the Docker image
    
      run: |
        Rscript -e 'descdir <- tempfile(pattern = "desc");dir.create(descdir);file.copy("DESCRIPTION", descdir);my_dock <- dock_from_desc(file.path(descdir, "DESCRIPTION"));my_dock$write("Dockerfile")'
        docker build . --file Dockerfile --tag my-image-name:$(date +%s)
