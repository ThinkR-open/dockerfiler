---
title: "Dockerfile from renv.lock"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Dockerfile from renv.lock}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(dockerfiler)
```

<!-- WARNING - This vignette is generated by {fusen} from /dev/flat_dock_from_renv.Rmd: do not edit by hand -->

<!--
 You need to run the 'description' chunk in the '0-dev_history.Rmd' file before continuing your code there.
-->


# Create a Dockerfile from a renv.lock file

```{r dock_from_renv, eval = FALSE}
# A temporary directory
dir_build <- tempfile(pattern = "renv")
dir.create(dir_build)

# Create a lockfile
the_lockfile <- file.path(dir_build, "renv.lock")
custom_packages <- c(
  # attachment::att_from_description(), # build from a DESCRIPTION file
  "renv",
  "cli", "glue", "golem", "shiny", "stats", "utils",
  "testthat",
  "knitr"
)
renv::snapshot(
  packages = custom_packages,
  lockfile = the_lockfile,
  prompt = FALSE)

# Create Dockerfile
my_dock <- dock_from_renv(lockfile = the_lockfile,
               distro = "focal", 
               FROM = "rstudio/verse"
              )
my_dock$write(file.path(dir_build, "Dockerfile"))
# rstudioapi::navigateToFile(file.path(dir_build, "Dockerfile"))
unlink(dir_build)
```

